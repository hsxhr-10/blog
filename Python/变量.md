# 变量

## 变量的查找顺序

局部变量（函数内、方法内）-> 闭包变量 -> 全局变量 -> import -> 内置变量 -> 报错

## 变量的作用域

在控制语句内（`if`、`for`、`while` 等），如果对全局变量进行赋值操作，全局变量不会变成局部变量：

```python
In [174]: x = 1

In [175]: if True:
     ...:     print(x)
     ...:     x = 2
     ...:     print(x)
     ...:
1
2
```

在函数、类的声明语句内（`def`、`class`、`lambda`），如果对全局变量进行赋值操作，全局变量会变成局部变量，这是个大坑，可能会造成奇形怪状的问题：

```python
In [176]: x = 1

In [177]: def foo():
     ...:     print(x)
     ...:     x = 2
     ...:     print(x)
     ...:

In [178]: foo()
---------------------------------------------------------------------------
UnboundLocalError                         Traceback (most recent call last)
<ipython-input-178-c19b6d9633cf> in <module>
----> 1 foo()

<ipython-input-177-15f508d05458> in foo()
      1 def foo():
----> 2     print(x)
      3     x = 2
      4     print(x)
      5

UnboundLocalError: local variable 'x' referenced before assignment
```

解决方法是在函数、类内使用全局变量时，显式用 `global` 声明：

```python
In [181]: x = 1

In [182]: def foo():
     ...:     global x
     ...:     print(x)
     ...:     x = 2
     ...:     print(x)
     ...:

In [183]: foo()
1
2
```

## 变量的类型

类型决定着可以存放的数据，以及可以提供哪些操作。一门语言所提供类型的丰富程度，很大程度上影响着开发效率，试想一下，Java 没了 util 包下的集合框架会是什么情景😂

### 基本类型

- int：理论上可以代表任意大的整数，在和 C 混合编程时，可能会造成 C 的类型溢出
- float：同上
- bool
- 字符串：Python2.x 的字符串是 str，Python3.x 的是 Unicode 容器，在用 Cython 时可能会有困扰

### 复合类型

- list：动态数组，可以当列表、栈、队列来用，但是你懂的，动态数组嘛，优势在于尾部的增删和随机访问，其他用途就别想了，本来 Python 的性能就不够用了😂
- dict：映射表，底层是哈希表还是红黑树还没确定（TODO）
- set：集合，使用场景就去重、集合运算啥的
- collections 包下的
    - deque：双端队列，真想要队列就用它吧
    - OrderDict：有序映射表
    - Counter：一个映射表计数器，格式为 {key: 对应的统计个数}。常见的使用场景为 符合格式要求的 dict 之间的运算、字符串统计中每个单词个数统计等
- queue 包：支持先进先出队列、后进先出队列、优先队列等，线程安全
- heapq 包：二项堆，做优先队列

> 没特殊说明的都是线程不安全的
