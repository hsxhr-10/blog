# 单例模式(Singleton)

单例模式的定义：

1. 一个类只能实例化一个对象
2. 单例对象必须由单例类创建
3. 单例类必须对外提供一个方法，用来访问单例对象

单例模式的作用：

1. 用于设置全局资源访问点
2. 节省内存

## 类图

![](https://raw.githubusercontent.com/hsxhr-10/Blog/master/image/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-1.png)

说明：

- `Singleton()` 私有的构造函数，确保外部类不能用直接用单例类创建实例
- `- instalce:Singleton` 私有属性，单例类创建的唯一对象
- `getInstance()` 给外部类访问单例对象的方法
- `# instance:Singleton` 外部访问类通过 `getInstance()` 方法获取到的单例对象

## 实现

### 线程不安全

#### Python 版本

```python
import threading
import time


class Singleton:
    def __init__(self):
        # 模拟耗时操作, 更好地复现每次创建的对象是不一样的
        time.sleep(1)

    @staticmethod
    def get_instance():
        if not hasattr(Singleton, "_instance"):
            Singleton._instance = Singleton()

        return Singleton._instance


def task():
    obj = Singleton()
    print(obj)


if __name__ == "__main__":
    workers = []
    for _ in range(10):
        t = threading.Thread(target=task)
        workers.append(t)

    for w in workers:
        w.start()
```

执行结果如下：

![]()

#### Java 版本

### 线程安全
